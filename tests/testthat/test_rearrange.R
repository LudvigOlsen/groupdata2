library(groupdata2)
context("rearrange()")

test_that("rearrange() with method pair_extremes works", {

  # Create data frame
  xpectr::set_test_seed(1)
  df <- data.frame(
    "participant" = factor(c(1, 3, 5, 6, 7, 8, 9)),
    "score" = c(79, 85, 140, 69, 87, 92, 87)
  )
  df <- df %>% dplyr::arrange(score)

  # with unequal number of rows
  df_rearranged <- rearrange(df,
    method = "pair_extremes",
    unequal_method = "first",
    keep_factor = TRUE
  )
  expect_equal(df_rearranged$.rearrange_factor, factor(c(1, 2, 2, 3, 3, 4, 4)))
  expect_equal(df_rearranged$participant, factor(c(6, 1, 5, 3, 8, 7, 9)))
  expect_equal(df_rearranged$score, c(69, 79, 140, 85, 92, 87, 87))

  df_rearranged <- rearrange(df,
    method = "pair_extremes",
    unequal_method = "middle",
    keep_factor = TRUE
  )
  expect_equal(df_rearranged$.rearrange_factor, factor(c(1, 1, 2, 2, 3, 4, 4)))
  expect_equal(df_rearranged$participant, factor(c(6, 5, 1, 8, 7, 3, 9)))
  expect_equal(df_rearranged$score, c(69, 140, 79, 92, 87, 85, 87))

  df_rearranged <- rearrange(df,
    method = "pair_extremes",
    unequal_method = "last",
    keep_factor = TRUE
  )
  expect_equal(df_rearranged$.rearrange_factor, factor(c(1, 1, 2, 2, 3, 3, 4)))
  expect_equal(df_rearranged$participant, factor(c(6, 8, 1, 9, 3, 7, 5)))
  expect_equal(df_rearranged$score, c(69, 92, 79, 87, 85, 87, 140))


  # with equal number of rows

  df <- df %>%
    dplyr::filter(dplyr::row_number() != 5) %>%
    droplevels()

  df_rearranged <- rearrange(df,
    method = "pair_extremes",
    unequal_method = "first",
    keep_factor = TRUE
  )
  expect_equal(df_rearranged$.rearrange_factor, factor(c(1, 1, 2, 2, 3, 3)))
  expect_equal(df_rearranged$participant, factor(c(6, 5, 1, 8, 3, 7)))
  expect_equal(df_rearranged$score, c(69, 140, 79, 92, 85, 87))

  df_rearranged <- rearrange(df,
    method = "pair_extremes",
    unequal_method = "middle",
    keep_factor = TRUE
  )
  expect_equal(df_rearranged$.rearrange_factor, factor(c(1, 1, 2, 2, 3, 3)))
  expect_equal(df_rearranged$participant, factor(c(6, 5, 1, 8, 3, 7)))
  expect_equal(df_rearranged$score, c(69, 140, 79, 92, 85, 87))

  df_rearranged <- rearrange(df,
    method = "pair_extremes",
    unequal_method = "last",
    keep_factor = TRUE
  )
  expect_equal(df_rearranged$.rearrange_factor, factor(c(1, 1, 2, 2, 3, 3)))
  expect_equal(df_rearranged$participant, factor(c(6, 5, 1, 8, 3, 7)))
  expect_equal(df_rearranged$score, c(69, 140, 79, 92, 85, 87))
})

test_that("rearrange() with method pair_extremes throws expected errors", {
  df <- data.frame("a" = c(1,2,3))

  ## Testing 'rearrange(df, method = "pair_lols", unequal_...'              ####
  ## Initially generated by xpectr
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_12655 <- xpectr::capture_side_effects(rearrange(df,
              method = "pair_lols",
              unequal_method = "first",
              keep_factor = TRUE
    ), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_12655[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'method': Must be a subset of set {pair_extremes,center_max,center_min}."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_12655[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)
  ## Finished testing 'rearrange(df, method = "pair_lols", unequal_...'     ####


  ## Testing 'rearrange(df, method = "pair_extremes", uneq...'              ####
  ## Initially generated by xpectr
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_19148 <- xpectr::capture_side_effects(rearrange(df,
              method = "pair_extremes",
              unequal_method = "none",
              keep_factor = TRUE
    ), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19148[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'unequal_method': Must be a subset of set {first,middle,last}."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19148[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)
  ## Finished testing 'rearrange(df, method = "pair_extremes", uneq...'     ####

})

test_that("create_rearrange_factor_pair_extremes_() works", {

  # unequal_method "middle"

  # Equal size
  expect_equal(create_rearrange_factor_pair_extremes_(40, unequal_method = "middle"), c(c(1:20), rev(c(1:20))))
  expect_equal(create_rearrange_factor_pair_extremes_(200, unequal_method = "middle"), c(c(1:100), rev(c(1:100))))

  # Unequal size
  expect_equal(create_rearrange_factor_pair_extremes_(41, unequal_method = "middle"), c(c(1:10, 12:21), 11, rev(c(1:10, 12:21))))
  expect_equal(create_rearrange_factor_pair_extremes_(201, unequal_method = "middle"), c(c(1:50, 52:101), 51, rev(c(1:50, 52:101))))

  # unequal_method "first"

  # Equal size
  expect_equal(create_rearrange_factor_pair_extremes_(40, unequal_method = "first"), c(c(1:20), rev(c(1:20))))
  expect_equal(create_rearrange_factor_pair_extremes_(200, unequal_method = "first"), c(c(1:100), rev(c(1:100))))

  # Unequal size
  expect_equal(create_rearrange_factor_pair_extremes_(41, unequal_method = "first"), c(1, c(c(1:20), rev(c(1:20))) + 1))
  expect_equal(create_rearrange_factor_pair_extremes_(201, unequal_method = "first"), c(1, c(c(1:100), rev(c(1:100))) + 1))

  # unequal_method "last"

  # Equal size
  expect_equal(create_rearrange_factor_pair_extremes_(40, unequal_method = "last"), c(c(1:20), rev(c(1:20))))
  expect_equal(create_rearrange_factor_pair_extremes_(200, unequal_method = "last"), c(c(1:100), rev(c(1:100))))

  # Unequal size
  expect_equal(create_rearrange_factor_pair_extremes_(41, unequal_method = "last"), c(c(c(1:20), rev(c(1:20))), 21))
  expect_equal(create_rearrange_factor_pair_extremes_(201, unequal_method = "last"), c(c(c(1:100), rev(c(1:100))), 101))
})

test_that("rearrange() with method pair_extremes works on vectors", {

  # Create data frame
  xpectr::set_test_seed(1)
  score <- sort(c(79, 85, 140, 69, 87, 92, 87))

  # with unequal number of rows
  df_rearranged <- rearrange(score,
    method = "pair_extremes",
    unequal_method = "first",
    keep_factor = TRUE
  ) %>%
    dplyr::rename(score = Value)
  expect_equal(df_rearranged$.rearrange_factor, factor(c(1, 2, 2, 3, 3, 4, 4)))
  expect_equal(df_rearranged$score, c(69, 79, 140, 85, 92, 87, 87))

  df_rearranged <- rearrange(score,
    method = "pair_extremes",
    unequal_method = "middle",
    keep_factor = TRUE
  ) %>%
    dplyr::rename(score = Value)
  expect_equal(df_rearranged$.rearrange_factor, factor(c(1, 1, 2, 2, 3, 4, 4)))
  expect_equal(df_rearranged$score, c(69, 140, 79, 92, 87, 85, 87))

  df_rearranged <- rearrange(score,
    method = "pair_extremes",
    unequal_method = "last",
    keep_factor = TRUE
  ) %>%
    dplyr::rename(score = Value)
  expect_equal(df_rearranged$.rearrange_factor, factor(c(1, 1, 2, 2, 3, 3, 4)))
  expect_equal(df_rearranged$score, c(69, 92, 79, 87, 85, 87, 140))


  # with equal number of rows
  score <- c(head(score, 4), tail(score, 2))

  df_rearranged <- rearrange(score,
    method = "pair_extremes",
    unequal_method = "first",
    keep_factor = TRUE
  ) %>%
    dplyr::rename(score = Value)
  expect_equal(df_rearranged$.rearrange_factor, factor(c(1, 1, 2, 2, 3, 3)))
  expect_equal(df_rearranged$score, c(69, 140, 79, 92, 85, 87))

  df_rearranged <- rearrange(score,
    method = "pair_extremes",
    unequal_method = "middle",
    keep_factor = TRUE
  ) %>%
    dplyr::rename(score = Value)
  expect_equal(df_rearranged$.rearrange_factor, factor(c(1, 1, 2, 2, 3, 3)))
  expect_equal(df_rearranged$score, c(69, 140, 79, 92, 85, 87))

  df_rearranged <- rearrange(score,
    method = "pair_extremes",
    unequal_method = "last",
    keep_factor = TRUE
  ) %>%
    dplyr::rename(score = Value)
  expect_equal(df_rearranged$.rearrange_factor, factor(c(1, 1, 2, 2, 3, 3)))
  expect_equal(df_rearranged$score, c(69, 140, 79, 92, 85, 87))
})

test_that("fuzz testing pair_extremes method for rearrange()", {
  xpectr::set_test_seed(42)

  # Create a data frame
  df <- data.frame(
    "index" = 1:9,
    "A" = sample(1:9),
    "B" = runif(9),
    "C" = LETTERS[1:9],
    stringsAsFactors = FALSE
  )

  # Generate expectations for 'rearrange' for pair_extremes method
  # Tip: comment out the gxs_function() call
  # so it is easy to regenerate the tests
  xpectr::set_test_seed(42)
  # xpectr::gxs_function(
  #   fn = rearrange,
  #   args_values = list(
  #     "data" = list(df, head(df, 8), c(1,2,3,4,5,6,7), c(1,2,3,4),
  #                   factor(c(1,2,3,4,5,6,7,1,2,3)), list(1,2,3), NA, 1),
  #     "col" = list(NULL, "A", "B", "C"),
  #     "method" = list("pair_extremes", "lol", NA),
  #     "unequal_method" = list("middle", "first", "last"),
  #     "shuffle_members" = list(FALSE, TRUE),
  #     "shuffle_pairs" = list(FALSE, TRUE),
  #     "keep_factor" = list(FALSE, TRUE),
  #     "factor_name" = list(".rearrange_factor", 1, NA)
  #   ),
  #   extra_combinations = list(
  #     list("data" = c(1,2,3,4), "col" = "A"),
  #     list("data" = c(1,2,3,4), "keep_factor" = TRUE, "factor_name" = "another_name"),
  #     list("shuffle_members" = TRUE, "shuffle_pairs" = TRUE)
  #   ),
  #   indentation = 2
  # )


  ## Testing 'rearrange'                                                      ####
  ## Initially generated by xpectr
  # Testing different combinations of argument values

  # Testing rearrange(data = df, col = NULL, method = "p...
  xpectr::set_test_seed(42)
  # Assigning output
  output_19148 <- rearrange(data = df, col = NULL, method = "pair_extremes", unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_19148),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_19148[["index"]],
    c(1, 9, 2, 8, 5, 3, 7, 4, 6),
    tolerance = 1e-4)
  expect_equal(
    output_19148[["A"]],
    c(9, 2, 8, 1, 4, 3, 6, 5, 7),
    tolerance = 1e-4)
  expect_equal(
    output_19148[["B"]],
    c(0.70506, 0.11749, 0.45774, 0.97823, 0.25543, 0.71911, 0.94001,
      0.93467, 0.46229),
    tolerance = 1e-4)
  expect_equal(
    output_19148[["C"]],
    c("A", "I", "B", "H", "E", "C", "G", "D", "F"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_19148),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_19148),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_19148),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_19148),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_19148)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = head(df, 8), col = NULL, me...
  # Changed from baseline: data = head(df, 8)
  xpectr::set_test_seed(42)
  # Assigning output
  output_19370 <- rearrange(data = head(df, 8), col = NULL, method = "pair_extremes", unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_19370),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_19370[["index"]],
    c(1, 8, 2, 7, 3, 6, 4, 5),
    tolerance = 1e-4)
  expect_equal(
    output_19370[["A"]],
    c(9, 1, 8, 6, 3, 7, 5, 4),
    tolerance = 1e-4)
  expect_equal(
    output_19370[["B"]],
    c(0.70506, 0.97823, 0.45774, 0.94001, 0.71911, 0.46229, 0.93467,
      0.25543),
    tolerance = 1e-4)
  expect_equal(
    output_19370[["C"]],
    c("A", "H", "B", "G", "C", "F", "D", "E"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_19370),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_19370),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_19370),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_19370),
    c(8L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_19370)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = c(1, 2, 3, 4, 5, 6, 7), col...
  # Changed from baseline: data = c(1, 2, 3, 4, ...
  xpectr::set_test_seed(42)
  # Assigning output
  output_12861 <- rearrange(data = c(1, 2, 3, 4, 5, 6, 7), col = NULL, method = "pair_extremes", unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_12861),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_12861[["Value"]],
    c(1, 7, 2, 6, 4, 3, 5),
    tolerance = 1e-4)
  # Testing column names
  expect_equal(
    names(output_12861),
    "Value",
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_12861),
    "numeric",
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_12861),
    "double",
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_12861),
    c(7L, 1L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_12861)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = c(1, 2, 3, 4), col = NULL, ...
  # Changed from baseline: data = c(1, 2, 3, 4)
  xpectr::set_test_seed(42)
  # Assigning output
  output_18304 <- rearrange(data = c(1, 2, 3, 4), col = NULL, method = "pair_extremes", unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_18304),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_18304[["Value"]],
    c(1, 4, 2, 3),
    tolerance = 1e-4)
  # Testing column names
  expect_equal(
    names(output_18304),
    "Value",
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_18304),
    "numeric",
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_18304),
    "double",
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_18304),
    c(4L, 1L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_18304)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = factor(c(1, 2, 3, 4, 5, 6, ...
  # Changed from baseline: data = factor(c(1, 2,...
  xpectr::set_test_seed(42)
  # Assigning output
  output_16417 <- rearrange(data = factor(c(1, 2, 3, 4, 5, 6, 7, 1, 2, 3)), col = NULL, method = "pair_extremes", unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_16417),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_16417[["Value"]],
    structure(c(1L, 7L, 1L, 6L, 2L, 5L, 2L, 4L, 3L, 3L), .Label = c("1",
      "2", "3", "4", "5", "6", "7"), class = "factor"))
  # Testing column names
  expect_equal(
    names(output_16417),
    "Value",
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_16417),
    "factor",
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_16417),
    "integer",
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_16417),
    c(10L, 1L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_16417)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = list(1, 2, 3), col = NULL, ...
  # Changed from baseline: data = list(1, 2, 3)
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_15190 <- xpectr::capture_side_effects(rearrange(data = list(1, 2, 3), col = NULL, method = "pair_extremes", unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_15190[['error']]),
    xpectr::strip("1 assertions failed:\n * when 'data' is not a data frame, it cannot be a list."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_15190[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = NA, col = NULL, method = "p...
  # Changed from baseline: data = NA
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_17365 <- xpectr::capture_side_effects(rearrange(data = NA, col = NULL, method = "pair_extremes", unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_17365[['error']]),
    xpectr::strip("Assertion failed. One of the following must apply:\n * checkmate::check_data_frame(data): Must be of type 'data.frame', not 'logical'\n * checkmate::check_vector(data): Contains missing values (element 1)\n * checkmate::check_factor(data): Contains missing values (element 1)"),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_17365[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = 1, col = NULL, method = "pa...
  # Changed from baseline: data = 1
  xpectr::set_test_seed(42)
  # Assigning output
  output_11346 <- rearrange(data = 1, col = NULL, method = "pair_extremes", unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_11346),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_11346[["Value"]],
    1,
    tolerance = 1e-4)
  # Testing column names
  expect_equal(
    names(output_11346),
    "Value",
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_11346),
    "numeric",
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_11346),
    "double",
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_11346),
    c(1L, 1L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_11346)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = NULL, col = NULL, method = ...
  # Changed from baseline: data = NULL
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_16569 <- xpectr::capture_side_effects(rearrange(data = NULL, col = NULL, method = "pair_extremes", unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_16569[['error']]),
    xpectr::strip("Assertion failed. One of the following must apply:\n * checkmate::check_data_frame(data): Must be of type 'data.frame', not 'NULL'\n * checkmate::check_vector(data): Must be of type 'vector', not 'NULL'\n * checkmate::check_factor(data): Must be of type 'factor', not 'NULL'"),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_16569[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = c(1, 2, 3, 4), col = "A", m...
  # Changed from baseline: data, col
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_17050 <- xpectr::capture_side_effects(rearrange(data = c(1, 2, 3, 4), col = "A", method = "pair_extremes", unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_17050[['error']]),
    xpectr::strip("1 assertions failed:\n * when 'data' is not a data frame, 'col' must be 'NULL'."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_17050[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = c(1, 2, 3, 4), col = NULL, ...
  # Changed from baseline: data, keep_factor, fa...
  xpectr::set_test_seed(42)
  # Assigning output
  output_14577 <- rearrange(data = c(1, 2, 3, 4), col = NULL, method = "pair_extremes", unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = TRUE, factor_name = "another_name")
  # Testing class
  expect_equal(
    class(output_14577),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_14577[["Value"]],
    c(1, 4, 2, 3),
    tolerance = 1e-4)
  expect_equal(
    output_14577[["another_name"]],
    structure(c(1L, 1L, 2L, 2L), .Label = c("1", "2"), class = "factor"))
  # Testing column names
  expect_equal(
    names(output_14577),
    c("Value", "another_name"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_14577),
    c("numeric", "factor"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_14577),
    c("double", "integer"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_14577),
    c(4L, 2L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_14577)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = "C", method = "pa...
  # Changed from baseline: col = "C"
  xpectr::set_test_seed(42)
  # Assigning output
  output_17191 <- rearrange(data = df, col = "C", method = "pair_extremes", unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_17191),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_17191[["index"]],
    c(1, 9, 2, 8, 5, 3, 7, 4, 6),
    tolerance = 1e-4)
  expect_equal(
    output_17191[["A"]],
    c(9, 2, 8, 1, 4, 3, 6, 5, 7),
    tolerance = 1e-4)
  expect_equal(
    output_17191[["B"]],
    c(0.70506, 0.11749, 0.45774, 0.97823, 0.25543, 0.71911, 0.94001,
      0.93467, 0.46229),
    tolerance = 1e-4)
  expect_equal(
    output_17191[["C"]],
    c("A", "I", "B", "H", "E", "C", "G", "D", "F"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_17191),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_17191),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_17191),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_17191),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_17191)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = "A", method = "pa...
  # Changed from baseline: col = "A"
  xpectr::set_test_seed(42)
  # Assigning output
  output_19346 <- rearrange(data = df, col = "A", method = "pair_extremes", unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_19346),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_19346[["index"]],
    c(8, 1, 9, 2, 4, 3, 6, 5, 7),
    tolerance = 1e-4)
  expect_equal(
    output_19346[["A"]],
    c(1, 9, 2, 8, 5, 3, 7, 4, 6),
    tolerance = 1e-4)
  expect_equal(
    output_19346[["B"]],
    c(0.97823, 0.70506, 0.11749, 0.45774, 0.93467, 0.71911, 0.46229,
      0.25543, 0.94001),
    tolerance = 1e-4)
  expect_equal(
    output_19346[["C"]],
    c("H", "A", "I", "B", "D", "C", "F", "E", "G"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_19346),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_19346),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_19346),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_19346),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_19346)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = "B", method = "pa...
  # Changed from baseline: col = "B"
  xpectr::set_test_seed(42)
  # Assigning output
  output_12554 <- rearrange(data = df, col = "B", method = "pair_extremes", unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_12554),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_12554[["index"]],
    c(9, 8, 5, 7, 1, 2, 4, 6, 3),
    tolerance = 1e-4)
  expect_equal(
    output_12554[["A"]],
    c(2, 1, 4, 6, 9, 8, 5, 7, 3),
    tolerance = 1e-4)
  expect_equal(
    output_12554[["B"]],
    c(0.11749, 0.97823, 0.25543, 0.94001, 0.70506, 0.45774, 0.93467,
      0.46229, 0.71911),
    tolerance = 1e-4)
  expect_equal(
    output_12554[["C"]],
    c("I", "H", "E", "G", "A", "B", "D", "F", "C"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_12554),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_12554),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_12554),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_12554),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_12554)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "l...
  # Changed from baseline: method = "lol"
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_14622 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = "lol", unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_14622[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'method': Must be a subset of set {pair_extremes,center_max,center_min}."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_14622[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = NA...
  # Changed from baseline: method = NA
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_19400 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = NA, unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19400[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'method': May not be NA."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19400[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = NU...
  # Changed from baseline: method = NULL
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_19782 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = NULL, unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19782[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'method': Must be of type 'string', not 'NULL'."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19782[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "p...
  # Changed from baseline: unequal_method = "first"
  xpectr::set_test_seed(42)
  # Assigning output
  output_11174 <- rearrange(data = df, col = NULL, method = "pair_extremes", unequal_method = "first", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_11174),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_11174[["index"]],
    c(1, 2, 9, 3, 8, 4, 7, 5, 6),
    tolerance = 1e-4)
  expect_equal(
    output_11174[["A"]],
    c(9, 8, 2, 3, 1, 5, 6, 4, 7),
    tolerance = 1e-4)
  expect_equal(
    output_11174[["B"]],
    c(0.70506, 0.45774, 0.11749, 0.71911, 0.97823, 0.93467, 0.94001,
      0.25543, 0.46229),
    tolerance = 1e-4)
  expect_equal(
    output_11174[["C"]],
    c("A", "B", "I", "C", "H", "D", "G", "E", "F"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_11174),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_11174),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_11174),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_11174),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_11174)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "p...
  # Changed from baseline: unequal_method = "last"
  xpectr::set_test_seed(42)
  # Assigning output
  output_14749 <- rearrange(data = df, col = NULL, method = "pair_extremes", unequal_method = "last", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_14749),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_14749[["index"]],
    c(1, 8, 2, 7, 3, 6, 4, 5, 9),
    tolerance = 1e-4)
  expect_equal(
    output_14749[["A"]],
    c(9, 1, 8, 6, 3, 7, 5, 4, 2),
    tolerance = 1e-4)
  expect_equal(
    output_14749[["B"]],
    c(0.70506, 0.97823, 0.45774, 0.94001, 0.71911, 0.46229, 0.93467,
      0.25543, 0.11749),
    tolerance = 1e-4)
  expect_equal(
    output_14749[["C"]],
    c("A", "H", "B", "G", "C", "F", "D", "E", "I"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_14749),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_14749),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_14749),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_14749),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_14749)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "p...
  # Changed from baseline: unequal_method = NULL
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_15603 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = "pair_extremes", unequal_method = NULL, shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_15603[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'unequal_method': Must be of type 'string', not 'NULL'."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_15603[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "p...
  # Changed from baseline: shuffle_members = TRUE
  xpectr::set_test_seed(42)
  # Assigning output
  output_19040 <- rearrange(data = df, col = NULL, method = "pair_extremes", unequal_method = "middle", shuffle_members = TRUE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_19040),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_19040[["index"]],
    c(9, 1, 8, 2, 5, 3, 7, 6, 4),
    tolerance = 1e-4)
  expect_equal(
    output_19040[["A"]],
    c(2, 9, 1, 8, 4, 3, 6, 7, 5),
    tolerance = 1e-4)
  expect_equal(
    output_19040[["B"]],
    c(0.11749, 0.70506, 0.97823, 0.45774, 0.25543, 0.71911, 0.94001,
      0.46229, 0.93467),
    tolerance = 1e-4)
  expect_equal(
    output_19040[["C"]],
    c("I", "A", "H", "B", "E", "C", "G", "F", "D"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_19040),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_19040),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_19040),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_19040),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_19040)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "p...
  # Changed from baseline: shuffle_members = NULL
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_11387 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = "pair_extremes", unequal_method = "middle", shuffle_members = NULL, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_11387[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'shuffle_members': Must be of type 'logical flag', not 'NULL'."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_11387[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "p...
  # Changed from baseline: shuffle_members, shuf...
  xpectr::set_test_seed(42)
  # Assigning output
  output_19888 <- rearrange(data = df, col = NULL, method = "pair_extremes", unequal_method = "middle", shuffle_members = TRUE, shuffle_pairs = TRUE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_19888),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_19888[["index"]],
    c(5, 6, 4, 9, 1, 2, 8, 3, 7),
    tolerance = 1e-4)
  expect_equal(
    output_19888[["A"]],
    c(4, 7, 5, 2, 9, 8, 1, 3, 6),
    tolerance = 1e-4)
  expect_equal(
    output_19888[["B"]],
    c(0.25543, 0.46229, 0.93467, 0.11749, 0.70506, 0.45774, 0.97823,
      0.71911, 0.94001),
    tolerance = 1e-4)
  expect_equal(
    output_19888[["C"]],
    c("E", "F", "D", "I", "A", "B", "H", "C", "G"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_19888),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_19888),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_19888),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_19888),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_19888)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "p...
  # Changed from baseline: shuffle_pairs = TRUE
  xpectr::set_test_seed(42)
  # Assigning output
  output_19466 <- rearrange(data = df, col = NULL, method = "pair_extremes", unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = TRUE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_19466),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_19466[["index"]],
    c(5, 4, 6, 1, 9, 2, 8, 3, 7),
    tolerance = 1e-4)
  expect_equal(
    output_19466[["A"]],
    c(4, 5, 7, 9, 2, 8, 1, 3, 6),
    tolerance = 1e-4)
  expect_equal(
    output_19466[["B"]],
    c(0.25543, 0.93467, 0.46229, 0.70506, 0.11749, 0.45774, 0.97823,
      0.71911, 0.94001),
    tolerance = 1e-4)
  expect_equal(
    output_19466[["C"]],
    c("E", "D", "F", "A", "I", "B", "H", "C", "G"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_19466),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_19466),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_19466),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_19466),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_19466)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "p...
  # Changed from baseline: shuffle_pairs = NULL
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_10824 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = "pair_extremes", unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = NULL, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_10824[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'shuffle_pairs': Must be of type 'logical flag', not 'NULL'."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_10824[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "p...
  # Changed from baseline: keep_factor = TRUE
  xpectr::set_test_seed(42)
  # Assigning output
  output_15142 <- rearrange(data = df, col = NULL, method = "pair_extremes", unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = TRUE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_15142),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_15142[["index"]],
    c(1, 9, 2, 8, 5, 3, 7, 4, 6),
    tolerance = 1e-4)
  expect_equal(
    output_15142[["A"]],
    c(9, 2, 8, 1, 4, 3, 6, 5, 7),
    tolerance = 1e-4)
  expect_equal(
    output_15142[["B"]],
    c(0.70506, 0.11749, 0.45774, 0.97823, 0.25543, 0.71911, 0.94001,
      0.93467, 0.46229),
    tolerance = 1e-4)
  expect_equal(
    output_15142[["C"]],
    c("A", "I", "B", "H", "E", "C", "G", "D", "F"),
    fixed = TRUE)
  expect_equal(
    output_15142[[".rearrange_factor"]],
    structure(c(1L, 1L, 2L, 2L, 3L, 4L, 4L, 5L, 5L), .Label = c("1",
      "2", "3", "4", "5"), class = "factor"))
  # Testing column names
  expect_equal(
    names(output_15142),
    c("index", "A", "B", "C", ".rearrange_factor"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_15142),
    c("integer", "integer", "numeric", "character", "factor"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_15142),
    c("integer", "integer", "double", "character", "integer"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_15142),
    c(9L, 5L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_15142)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "p...
  # Changed from baseline: keep_factor = NULL
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_13902 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = "pair_extremes", unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = NULL, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_13902[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'keep_factor': Must be of type 'logical flag', not 'NULL'."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_13902[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "p...
  # Changed from baseline: factor_name = 1
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_19057 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = "pair_extremes", unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = 1), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19057[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'factor_name': Must be of type 'string', not 'double'."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19057[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "p...
  # Changed from baseline: factor_name = NA
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_14469 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = "pair_extremes", unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = NA), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_14469[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'factor_name': May not be NA."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_14469[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "p...
  # Changed from baseline: factor_name = NULL
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_18360 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = "pair_extremes", unequal_method = "middle", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = NULL), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_18360[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'factor_name': Must be of type 'string', not 'NULL'."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_18360[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  ## Finished testing 'rearrange'                                             ####
  #

})

test_that("fuzz testing center_max method for rearrange()", {
  xpectr::set_test_seed(42)

  # Create a data frame
  df <- data.frame(
    "index" = 1:9,
    "A" = sample(1:9),
    "B" = runif(9),
    "C" = LETTERS[1:9],
    stringsAsFactors = FALSE
  )

  # Generate expectations for 'rearrange' for pair_extremes method
  # Tip: comment out the gxs_function() call
  # so it is easy to regenerate the tests
  xpectr::set_test_seed(42)
  # xpectr::gxs_function(
  #   fn = rearrange,
  #   args_values = list(
  #     "data" = list(df, head(df, 8), c(1,2,3,4,5,6,7), c(1,2,3,4),
  #                   factor(c(1,2,3,4,5,6,7,1,2,3)), list(1,2,3), NA, 1),
  #     "col" = list(NULL, "A", "B", "C"),
  #     "method" = list("center_max", "lol", NA),
  #     "shuffle_members" = list(FALSE, TRUE),
  #     "shuffle_pairs" = list(FALSE, TRUE),
  #     "keep_factor" = list(FALSE, TRUE),
  #     "factor_name" = list(".rearrange_factor", 1, NA)
  #   ),
  #   extra_combinations = list(
  #     list("data" = c(1,2,3,4), "col" = "A"),
  #     list("data" = c(1,2,3,4), "keep_factor" = TRUE, "factor_name" = "another_name")
  #   ),
  #   indentation = 2
  # )


  ## Testing 'rearrange'                                                      ####
  ## Initially generated by xpectr
  # Testing different combinations of argument values

  # Testing rearrange(data = df, col = NULL, method = "c...
  xpectr::set_test_seed(42)
  # Assigning output
  output_19148 <- rearrange(data = df, col = NULL, method = "center_max", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_19148),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_19148[["index"]],
    c(1, 3, 5, 7, 9, 8, 6, 4, 2),
    tolerance = 1e-4)
  expect_equal(
    output_19148[["A"]],
    c(9, 3, 4, 6, 2, 1, 7, 5, 8),
    tolerance = 1e-4)
  expect_equal(
    output_19148[["B"]],
    c(0.70506, 0.71911, 0.25543, 0.94001, 0.11749, 0.97823, 0.46229,
      0.93467, 0.45774),
    tolerance = 1e-4)
  expect_equal(
    output_19148[["C"]],
    c("A", "C", "E", "G", "I", "H", "F", "D", "B"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_19148),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_19148),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_19148),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_19148),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_19148)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = head(df, 8), col = NULL, me...
  # Changed from baseline: data = head(df, 8)
  xpectr::set_test_seed(42)
  # Assigning output
  output_19370 <- rearrange(data = head(df, 8), col = NULL, method = "center_max", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_19370),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_19370[["index"]],
    c(1, 3, 5, 7, 8, 6, 4, 2),
    tolerance = 1e-4)
  expect_equal(
    output_19370[["A"]],
    c(9, 3, 4, 6, 1, 7, 5, 8),
    tolerance = 1e-4)
  expect_equal(
    output_19370[["B"]],
    c(0.70506, 0.71911, 0.25543, 0.94001, 0.97823, 0.46229, 0.93467,
      0.45774),
    tolerance = 1e-4)
  expect_equal(
    output_19370[["C"]],
    c("A", "C", "E", "G", "H", "F", "D", "B"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_19370),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_19370),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_19370),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_19370),
    c(8L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_19370)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = c(1, 2, 3, 4, 5, 6, 7), col...
  # Changed from baseline: data = c(1, 2, 3, 4, ...
  xpectr::set_test_seed(42)
  # Assigning output
  output_12861 <- rearrange(data = c(1, 2, 3, 4, 5, 6, 7), col = NULL, method = "center_max", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_12861),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_12861[["Value"]],
    c(1, 3, 5, 7, 6, 4, 2),
    tolerance = 1e-4)
  # Testing column names
  expect_equal(
    names(output_12861),
    "Value",
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_12861),
    "numeric",
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_12861),
    "double",
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_12861),
    c(7L, 1L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_12861)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = c(1, 2, 3, 4), col = NULL, ...
  # Changed from baseline: data = c(1, 2, 3, 4)
  xpectr::set_test_seed(42)
  # Assigning output
  output_18304 <- rearrange(data = c(1, 2, 3, 4), col = NULL, method = "center_max", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_18304),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_18304[["Value"]],
    c(1, 3, 4, 2),
    tolerance = 1e-4)
  # Testing column names
  expect_equal(
    names(output_18304),
    "Value",
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_18304),
    "numeric",
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_18304),
    "double",
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_18304),
    c(4L, 1L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_18304)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = factor(c(1, 2, 3, 4, 5, 6, ...
  # Changed from baseline: data = factor(c(1, 2,...
  xpectr::set_test_seed(42)
  # Assigning output
  output_16417 <- rearrange(data = factor(c(1, 2, 3, 4, 5, 6, 7, 1, 2, 3)), col = NULL, method = "center_max", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_16417),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_16417[["Value"]],
    structure(c(1L, 2L, 3L, 4L, 6L, 7L, 5L, 3L, 2L, 1L), .Label = c("1",
      "2", "3", "4", "5", "6", "7"), class = "factor"))
  # Testing column names
  expect_equal(
    names(output_16417),
    "Value",
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_16417),
    "factor",
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_16417),
    "integer",
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_16417),
    c(10L, 1L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_16417)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = list(1, 2, 3), col = NULL, ...
  # Changed from baseline: data = list(1, 2, 3)
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_15190 <- xpectr::capture_side_effects(rearrange(data = list(1, 2, 3), col = NULL, method = "center_max", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_15190[['error']]),
    xpectr::strip("1 assertions failed:\n * when 'data' is not a data frame, it cannot be a list."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_15190[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = NA, col = NULL, method = "c...
  # Changed from baseline: data = NA
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_17365 <- xpectr::capture_side_effects(rearrange(data = NA, col = NULL, method = "center_max", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_17365[['error']]),
    xpectr::strip("Assertion failed. One of the following must apply:\n * checkmate::check_data_frame(data): Must be of type 'data.frame', not 'logical'\n * checkmate::check_vector(data): Contains missing values (element 1)\n * checkmate::check_factor(data): Contains missing values (element 1)"),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_17365[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = 1, col = NULL, method = "ce...
  # Changed from baseline: data = 1
  xpectr::set_test_seed(42)
  # Assigning output
  output_11346 <- rearrange(data = 1, col = NULL, method = "center_max", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_11346),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_11346[["Value"]],
    1,
    tolerance = 1e-4)
  # Testing column names
  expect_equal(
    names(output_11346),
    "Value",
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_11346),
    "numeric",
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_11346),
    "double",
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_11346),
    c(1L, 1L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_11346)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = NULL, col = NULL, method = ...
  # Changed from baseline: data = NULL
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_16569 <- xpectr::capture_side_effects(rearrange(data = NULL, col = NULL, method = "center_max", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_16569[['error']]),
    xpectr::strip("Assertion failed. One of the following must apply:\n * checkmate::check_data_frame(data): Must be of type 'data.frame', not 'NULL'\n * checkmate::check_vector(data): Must be of type 'vector', not 'NULL'\n * checkmate::check_factor(data): Must be of type 'factor', not 'NULL'"),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_16569[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = c(1, 2, 3, 4), col = "A", m...
  # Changed from baseline: data, col
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_17050 <- xpectr::capture_side_effects(rearrange(data = c(1, 2, 3, 4), col = "A", method = "center_max", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_17050[['error']]),
    xpectr::strip("1 assertions failed:\n * when 'data' is not a data frame, 'col' must be 'NULL'."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_17050[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = c(1, 2, 3, 4), col = NULL, ...
  # Changed from baseline: data, keep_factor, fa...
  xpectr::set_test_seed(42)
  # Assigning output
  output_14577 <- rearrange(data = c(1, 2, 3, 4), col = NULL, method = "center_max", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = TRUE, factor_name = "another_name")
  # Testing class
  expect_equal(
    class(output_14577),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_14577[["Value"]],
    c(1, 3, 4, 2),
    tolerance = 1e-4)
  expect_equal(
    output_14577[["another_name"]],
    structure(1:4, .Label = c("1", "2", "3", "4"), class = "factor"))
  # Testing column names
  expect_equal(
    names(output_14577),
    c("Value", "another_name"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_14577),
    c("numeric", "factor"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_14577),
    c("double", "integer"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_14577),
    c(4L, 2L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_14577)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = "C", method = "ce...
  # Changed from baseline: col = "C"
  xpectr::set_test_seed(42)
  # Assigning output
  output_17191 <- rearrange(data = df, col = "C", method = "center_max", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_17191),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_17191[["index"]],
    c(1, 3, 5, 7, 9, 8, 6, 4, 2),
    tolerance = 1e-4)
  expect_equal(
    output_17191[["A"]],
    c(9, 3, 4, 6, 2, 1, 7, 5, 8),
    tolerance = 1e-4)
  expect_equal(
    output_17191[["B"]],
    c(0.70506, 0.71911, 0.25543, 0.94001, 0.11749, 0.97823, 0.46229,
      0.93467, 0.45774),
    tolerance = 1e-4)
  expect_equal(
    output_17191[["C"]],
    c("A", "C", "E", "G", "I", "H", "F", "D", "B"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_17191),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_17191),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_17191),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_17191),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_17191)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = "A", method = "ce...
  # Changed from baseline: col = "A"
  xpectr::set_test_seed(42)
  # Assigning output
  output_19346 <- rearrange(data = df, col = "A", method = "center_max", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_19346),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_19346[["index"]],
    c(8, 3, 4, 6, 1, 2, 7, 5, 9),
    tolerance = 1e-4)
  expect_equal(
    output_19346[["A"]],
    c(1, 3, 5, 7, 9, 8, 6, 4, 2),
    tolerance = 1e-4)
  expect_equal(
    output_19346[["B"]],
    c(0.97823, 0.71911, 0.93467, 0.46229, 0.70506, 0.45774, 0.94001,
      0.25543, 0.11749),
    tolerance = 1e-4)
  expect_equal(
    output_19346[["C"]],
    c("H", "C", "D", "F", "A", "B", "G", "E", "I"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_19346),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_19346),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_19346),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_19346),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_19346)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = "B", method = "ce...
  # Changed from baseline: col = "B"
  xpectr::set_test_seed(42)
  # Assigning output
  output_12554 <- rearrange(data = df, col = "B", method = "center_max", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_12554),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_12554[["index"]],
    c(9, 2, 1, 4, 8, 7, 3, 6, 5),
    tolerance = 1e-4)
  expect_equal(
    output_12554[["A"]],
    c(2, 8, 9, 5, 1, 6, 3, 7, 4),
    tolerance = 1e-4)
  expect_equal(
    output_12554[["B"]],
    c(0.11749, 0.45774, 0.70506, 0.93467, 0.97823, 0.94001, 0.71911,
      0.46229, 0.25543),
    tolerance = 1e-4)
  expect_equal(
    output_12554[["C"]],
    c("I", "B", "A", "D", "H", "G", "C", "F", "E"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_12554),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_12554),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_12554),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_12554),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_12554)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "l...
  # Changed from baseline: method = "lol"
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_14622 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = "lol", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_14622[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'method': Must be a subset of set {pair_extremes,center_max,center_min}."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_14622[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = NA...
  # Changed from baseline: method = NA
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_19400 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = NA, shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19400[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'method': May not be NA."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19400[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = NU...
  # Changed from baseline: method = NULL
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_19782 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = NULL, shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19782[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'method': Must be of type 'string', not 'NULL'."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19782[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "c...
  # Changed from baseline: shuffle_members = TRUE
  xpectr::set_test_seed(42)
  # Assigning output
  output_11174 <- rearrange(data = df, col = NULL, method = "center_max", shuffle_members = TRUE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_11174),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_11174[["index"]],
    c(2, 4, 5, 8, 9, 7, 6, 3, 1),
    tolerance = 1e-4)
  expect_equal(
    output_11174[["A"]],
    c(8, 5, 4, 1, 2, 6, 7, 3, 9),
    tolerance = 1e-4)
  expect_equal(
    output_11174[["B"]],
    c(0.45774, 0.93467, 0.25543, 0.97823, 0.11749, 0.94001, 0.46229,
      0.71911, 0.70506),
    tolerance = 1e-4)
  expect_equal(
    output_11174[["C"]],
    c("B", "D", "E", "H", "I", "G", "F", "C", "A"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_11174),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_11174),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_11174),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_11174),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_11174)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "c...
  # Changed from baseline: shuffle_members = NULL
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_14749 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = "center_max", shuffle_members = NULL, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_14749[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'shuffle_members': Must be of type 'logical flag', not 'NULL'."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_14749[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "c...
  # Changed from baseline: shuffle_pairs = TRUE
  xpectr::set_test_seed(42)
  # Assigning output
  output_15603 <- rearrange(data = df, col = NULL, method = "center_max", shuffle_members = FALSE, shuffle_pairs = TRUE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_15603),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_15603[["index"]],
    c(1, 3, 5, 7, 9, 8, 6, 4, 2),
    tolerance = 1e-4)
  expect_equal(
    output_15603[["A"]],
    c(9, 3, 4, 6, 2, 1, 7, 5, 8),
    tolerance = 1e-4)
  expect_equal(
    output_15603[["B"]],
    c(0.70506, 0.71911, 0.25543, 0.94001, 0.11749, 0.97823, 0.46229,
      0.93467, 0.45774),
    tolerance = 1e-4)
  expect_equal(
    output_15603[["C"]],
    c("A", "C", "E", "G", "I", "H", "F", "D", "B"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_15603),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_15603),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_15603),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_15603),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_15603)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "c...
  # Changed from baseline: shuffle_pairs = NULL
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_19040 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = "center_max", shuffle_members = FALSE, shuffle_pairs = NULL, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19040[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'shuffle_pairs': Must be of type 'logical flag', not 'NULL'."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19040[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "c...
  # Changed from baseline: keep_factor = TRUE
  xpectr::set_test_seed(42)
  # Assigning output
  output_11387 <- rearrange(data = df, col = NULL, method = "center_max", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = TRUE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_11387),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_11387[["index"]],
    c(1, 3, 5, 7, 9, 8, 6, 4, 2),
    tolerance = 1e-4)
  expect_equal(
    output_11387[["A"]],
    c(9, 3, 4, 6, 2, 1, 7, 5, 8),
    tolerance = 1e-4)
  expect_equal(
    output_11387[["B"]],
    c(0.70506, 0.71911, 0.25543, 0.94001, 0.11749, 0.97823, 0.46229,
      0.93467, 0.45774),
    tolerance = 1e-4)
  expect_equal(
    output_11387[["C"]],
    c("A", "C", "E", "G", "I", "H", "F", "D", "B"),
    fixed = TRUE)
  expect_equal(
    output_11387[[".rearrange_factor"]],
    structure(1:9, .Label = c("1", "2", "3", "4", "5", "6", "7", "8",
      "9"), class = "factor"))
  # Testing column names
  expect_equal(
    names(output_11387),
    c("index", "A", "B", "C", ".rearrange_factor"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_11387),
    c("integer", "integer", "numeric", "character", "factor"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_11387),
    c("integer", "integer", "double", "character", "integer"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_11387),
    c(9L, 5L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_11387)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "c...
  # Changed from baseline: keep_factor = NULL
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_19888 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = "center_max", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = NULL, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19888[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'keep_factor': Must be of type 'logical flag', not 'NULL'."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19888[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "c...
  # Changed from baseline: factor_name = 1
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_19466 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = "center_max", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = 1), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19466[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'factor_name': Must be of type 'string', not 'double'."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19466[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "c...
  # Changed from baseline: factor_name = NA
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_10824 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = "center_max", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = NA), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_10824[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'factor_name': May not be NA."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_10824[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "c...
  # Changed from baseline: factor_name = NULL
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_15142 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = "center_max", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = NULL), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_15142[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'factor_name': Must be of type 'string', not 'NULL'."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_15142[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  ## Finished testing 'rearrange'                                             ####
  #

})

test_that("fuzz testing center_min method for rearrange()", {
  xpectr::set_test_seed(42)

  # Create a data frame
  df <- data.frame(
    "index" = 1:9,
    "A" = sample(1:9),
    "B" = runif(9),
    "C" = LETTERS[1:9],
    stringsAsFactors = FALSE
  )

  # Generate expectations for 'rearrange' for pair_extremes method
  # Tip: comment out the gxs_function() call
  # so it is easy to regenerate the tests
  xpectr::set_test_seed(42)
  # xpectr::gxs_function(
  #   fn = rearrange,
  #   args_values = list(
  #     "data" = list(df, head(df, 8), c(1,2,3,4,5,6,7), c(1,2,3,4),
  #                   factor(c(1,2,3,4,5,6,7,1,2,3)) ,list(1,2,3), NA, 1),
  #     "col" = list(NULL, "A", "B", "C"),
  #     "method" = list("center_min"),
  #     "shuffle_members" = list(FALSE, TRUE),
  #     "shuffle_pairs" = list(FALSE, TRUE),
  #     "keep_factor" = list(FALSE, TRUE),
  #     "factor_name" = list(".rearrange_factor")
  #   ),
  #   extra_combinations = list(
  #     list("data" = c(1,2,3,4), "col" = "A"),
  #     list("data" = c(1,2,3,4), "keep_factor" = TRUE, "factor_name" = "another_name")
  #   ),
  #   indentation = 2
  # )


  ## Testing 'rearrange'                                                      ####
  ## Initially generated by xpectr
  # Testing different combinations of argument values

  # Testing rearrange(data = df, col = NULL, method = "c...
  xpectr::set_test_seed(42)
  # Assigning output
  output_19148 <- rearrange(data = df, col = NULL, method = "center_min", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_19148),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_19148[["index"]],
    c(9, 7, 5, 3, 1, 2, 4, 6, 8),
    tolerance = 1e-4)
  expect_equal(
    output_19148[["A"]],
    c(2, 6, 4, 3, 9, 8, 5, 7, 1),
    tolerance = 1e-4)
  expect_equal(
    output_19148[["B"]],
    c(0.11749, 0.94001, 0.25543, 0.71911, 0.70506, 0.45774, 0.93467,
      0.46229, 0.97823),
    tolerance = 1e-4)
  expect_equal(
    output_19148[["C"]],
    c("I", "G", "E", "C", "A", "B", "D", "F", "H"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_19148),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_19148),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_19148),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_19148),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_19148)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = head(df, 8), col = NULL, me...
  # Changed from baseline: data = head(df, 8)
  xpectr::set_test_seed(42)
  # Assigning output
  output_19370 <- rearrange(data = head(df, 8), col = NULL, method = "center_min", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_19370),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_19370[["index"]],
    c(8, 6, 4, 2, 1, 3, 5, 7),
    tolerance = 1e-4)
  expect_equal(
    output_19370[["A"]],
    c(1, 7, 5, 8, 9, 3, 4, 6),
    tolerance = 1e-4)
  expect_equal(
    output_19370[["B"]],
    c(0.97823, 0.46229, 0.93467, 0.45774, 0.70506, 0.71911, 0.25543,
      0.94001),
    tolerance = 1e-4)
  expect_equal(
    output_19370[["C"]],
    c("H", "F", "D", "B", "A", "C", "E", "G"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_19370),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_19370),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_19370),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_19370),
    c(8L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_19370)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = c(1, 2, 3, 4, 5, 6, 7), col...
  # Changed from baseline: data = c(1, 2, 3, 4, ...
  xpectr::set_test_seed(42)
  # Assigning output
  output_12861 <- rearrange(data = c(1, 2, 3, 4, 5, 6, 7), col = NULL, method = "center_min", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_12861),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_12861[["Value"]],
    c(7, 5, 3, 1, 2, 4, 6),
    tolerance = 1e-4)
  # Testing column names
  expect_equal(
    names(output_12861),
    "Value",
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_12861),
    "numeric",
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_12861),
    "double",
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_12861),
    c(7L, 1L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_12861)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = c(1, 2, 3, 4), col = NULL, ...
  # Changed from baseline: data = c(1, 2, 3, 4)
  xpectr::set_test_seed(42)
  # Assigning output
  output_18304 <- rearrange(data = c(1, 2, 3, 4), col = NULL, method = "center_min", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_18304),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_18304[["Value"]],
    c(4, 2, 1, 3),
    tolerance = 1e-4)
  # Testing column names
  expect_equal(
    names(output_18304),
    "Value",
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_18304),
    "numeric",
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_18304),
    "double",
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_18304),
    c(4L, 1L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_18304)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = factor(c(1, 2, 3, 4, 5, 6, ...
  # Changed from baseline: data = factor(c(1, 2,...
  xpectr::set_test_seed(42)
  # Assigning output
  output_16417 <- rearrange(data = factor(c(1, 2, 3, 4, 5, 6, 7, 1, 2, 3)), col = NULL, method = "center_min", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_16417),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_16417[["Value"]],
    structure(c(7L, 5L, 3L, 2L, 1L, 1L, 2L, 3L, 4L, 6L), .Label = c("1",
      "2", "3", "4", "5", "6", "7"), class = "factor"))
  # Testing column names
  expect_equal(
    names(output_16417),
    "Value",
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_16417),
    "factor",
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_16417),
    "integer",
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_16417),
    c(10L, 1L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_16417)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = list(1, 2, 3), col = NULL, ...
  # Changed from baseline: data = list(1, 2, 3)
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_15190 <- xpectr::capture_side_effects(rearrange(data = list(1, 2, 3), col = NULL, method = "center_min", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_15190[['error']]),
    xpectr::strip("1 assertions failed:\n * when 'data' is not a data frame, it cannot be a list."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_15190[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = NA, col = NULL, method = "c...
  # Changed from baseline: data = NA
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_17365 <- xpectr::capture_side_effects(rearrange(data = NA, col = NULL, method = "center_min", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_17365[['error']]),
    xpectr::strip("Assertion failed. One of the following must apply:\n * checkmate::check_data_frame(data): Must be of type 'data.frame', not 'logical'\n * checkmate::check_vector(data): Contains missing values (element 1)\n * checkmate::check_factor(data): Contains missing values (element 1)"),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_17365[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = 1, col = NULL, method = "ce...
  # Changed from baseline: data = 1
  xpectr::set_test_seed(42)
  # Assigning output
  output_11346 <- rearrange(data = 1, col = NULL, method = "center_min", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_11346),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_11346[["Value"]],
    1,
    tolerance = 1e-4)
  # Testing column names
  expect_equal(
    names(output_11346),
    "Value",
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_11346),
    "numeric",
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_11346),
    "double",
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_11346),
    c(1L, 1L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_11346)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = NULL, col = NULL, method = ...
  # Changed from baseline: data = NULL
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_16569 <- xpectr::capture_side_effects(rearrange(data = NULL, col = NULL, method = "center_min", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_16569[['error']]),
    xpectr::strip("Assertion failed. One of the following must apply:\n * checkmate::check_data_frame(data): Must be of type 'data.frame', not 'NULL'\n * checkmate::check_vector(data): Must be of type 'vector', not 'NULL'\n * checkmate::check_factor(data): Must be of type 'factor', not 'NULL'"),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_16569[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = c(1, 2, 3, 4), col = "A", m...
  # Changed from baseline: data, col
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_17050 <- xpectr::capture_side_effects(rearrange(data = c(1, 2, 3, 4), col = "A", method = "center_min", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_17050[['error']]),
    xpectr::strip("1 assertions failed:\n * when 'data' is not a data frame, 'col' must be 'NULL'."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_17050[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = c(1, 2, 3, 4), col = NULL, ...
  # Changed from baseline: data, keep_factor, fa...
  xpectr::set_test_seed(42)
  # Assigning output
  output_14577 <- rearrange(data = c(1, 2, 3, 4), col = NULL, method = "center_min", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = TRUE, factor_name = "another_name")
  # Testing class
  expect_equal(
    class(output_14577),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_14577[["Value"]],
    c(4, 2, 1, 3),
    tolerance = 1e-4)
  expect_equal(
    output_14577[["another_name"]],
    structure(1:4, .Label = c("1", "2", "3", "4"), class = "factor"))
  # Testing column names
  expect_equal(
    names(output_14577),
    c("Value", "another_name"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_14577),
    c("numeric", "factor"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_14577),
    c("double", "integer"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_14577),
    c(4L, 2L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_14577)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = "C", method = "ce...
  # Changed from baseline: col = "C"
  xpectr::set_test_seed(42)
  # Assigning output
  output_17191 <- rearrange(data = df, col = "C", method = "center_min", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_17191),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_17191[["index"]],
    c(9, 7, 5, 3, 1, 2, 4, 6, 8),
    tolerance = 1e-4)
  expect_equal(
    output_17191[["A"]],
    c(2, 6, 4, 3, 9, 8, 5, 7, 1),
    tolerance = 1e-4)
  expect_equal(
    output_17191[["B"]],
    c(0.11749, 0.94001, 0.25543, 0.71911, 0.70506, 0.45774, 0.93467,
      0.46229, 0.97823),
    tolerance = 1e-4)
  expect_equal(
    output_17191[["C"]],
    c("I", "G", "E", "C", "A", "B", "D", "F", "H"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_17191),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_17191),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_17191),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_17191),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_17191)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = "A", method = "ce...
  # Changed from baseline: col = "A"
  xpectr::set_test_seed(42)
  # Assigning output
  output_19346 <- rearrange(data = df, col = "A", method = "center_min", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_19346),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_19346[["index"]],
    c(1, 6, 4, 3, 8, 9, 5, 7, 2),
    tolerance = 1e-4)
  expect_equal(
    output_19346[["A"]],
    c(9, 7, 5, 3, 1, 2, 4, 6, 8),
    tolerance = 1e-4)
  expect_equal(
    output_19346[["B"]],
    c(0.70506, 0.46229, 0.93467, 0.71911, 0.97823, 0.11749, 0.25543,
      0.94001, 0.45774),
    tolerance = 1e-4)
  expect_equal(
    output_19346[["C"]],
    c("A", "F", "D", "C", "H", "I", "E", "G", "B"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_19346),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_19346),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_19346),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_19346),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_19346)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = "B", method = "ce...
  # Changed from baseline: col = "B"
  xpectr::set_test_seed(42)
  # Assigning output
  output_12554 <- rearrange(data = df, col = "B", method = "center_min", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_12554),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_12554[["index"]],
    c(8, 4, 1, 2, 9, 5, 6, 3, 7),
    tolerance = 1e-4)
  expect_equal(
    output_12554[["A"]],
    c(1, 5, 9, 8, 2, 4, 7, 3, 6),
    tolerance = 1e-4)
  expect_equal(
    output_12554[["B"]],
    c(0.97823, 0.93467, 0.70506, 0.45774, 0.11749, 0.25543, 0.46229,
      0.71911, 0.94001),
    tolerance = 1e-4)
  expect_equal(
    output_12554[["C"]],
    c("H", "D", "A", "B", "I", "E", "F", "C", "G"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_12554),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_12554),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_12554),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_12554),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_12554)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "l...
  # Changed from baseline: method = "lol"
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_14622 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = "lol", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_14622[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'method': Must be a subset of set {pair_extremes,center_max,center_min}."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_14622[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = NA...
  # Changed from baseline: method = NA
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_19400 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = NA, shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19400[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'method': May not be NA."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19400[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = NU...
  # Changed from baseline: method = NULL
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_19782 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = NULL, shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19782[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'method': Must be of type 'string', not 'NULL'."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19782[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "c...
  # Changed from baseline: shuffle_members = TRUE
  xpectr::set_test_seed(42)
  # Assigning output
  output_11174 <- rearrange(data = df, col = NULL, method = "center_min", shuffle_members = TRUE, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_11174),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_11174[["index"]],
    c(8, 6, 5, 2, 1, 3, 4, 7, 9),
    tolerance = 1e-4)
  expect_equal(
    output_11174[["A"]],
    c(1, 7, 4, 8, 9, 3, 5, 6, 2),
    tolerance = 1e-4)
  expect_equal(
    output_11174[["B"]],
    c(0.97823, 0.46229, 0.25543, 0.45774, 0.70506, 0.71911, 0.93467,
      0.94001, 0.11749),
    tolerance = 1e-4)
  expect_equal(
    output_11174[["C"]],
    c("H", "F", "E", "B", "A", "C", "D", "G", "I"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_11174),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_11174),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_11174),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_11174),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_11174)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "c...
  # Changed from baseline: shuffle_members = NULL
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_14749 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = "center_min", shuffle_members = NULL, shuffle_pairs = FALSE, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_14749[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'shuffle_members': Must be of type 'logical flag', not 'NULL'."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_14749[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "c...
  # Changed from baseline: shuffle_pairs = TRUE
  xpectr::set_test_seed(42)
  # Assigning output
  output_15603 <- rearrange(data = df, col = NULL, method = "center_min", shuffle_members = FALSE, shuffle_pairs = TRUE, keep_factor = FALSE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_15603),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_15603[["index"]],
    c(9, 7, 5, 3, 1, 2, 4, 6, 8),
    tolerance = 1e-4)
  expect_equal(
    output_15603[["A"]],
    c(2, 6, 4, 3, 9, 8, 5, 7, 1),
    tolerance = 1e-4)
  expect_equal(
    output_15603[["B"]],
    c(0.11749, 0.94001, 0.25543, 0.71911, 0.70506, 0.45774, 0.93467,
      0.46229, 0.97823),
    tolerance = 1e-4)
  expect_equal(
    output_15603[["C"]],
    c("I", "G", "E", "C", "A", "B", "D", "F", "H"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_15603),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_15603),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_15603),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_15603),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_15603)),
    character(0),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "c...
  # Changed from baseline: shuffle_pairs = NULL
  xpectr::set_test_seed(42)
  # Testing side effects
  # Assigning side effects
  side_effects_19040 <- xpectr::capture_side_effects(rearrange(data = df, col = NULL, method = "center_min", shuffle_members = FALSE, shuffle_pairs = NULL, keep_factor = FALSE, factor_name = ".rearrange_factor"), reset_seed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19040[['error']]),
    xpectr::strip("1 assertions failed:\n * Variable 'shuffle_pairs': Must be of type 'logical flag', not 'NULL'."),
    fixed = TRUE)
  expect_equal(
    xpectr::strip(side_effects_19040[['error_class']]),
    xpectr::strip(c("simpleError", "error", "condition")),
    fixed = TRUE)

  # Testing rearrange(data = df, col = NULL, method = "c...
  # Changed from baseline: keep_factor = TRUE
  xpectr::set_test_seed(42)
  # Assigning output
  output_11387 <- rearrange(data = df, col = NULL, method = "center_min", shuffle_members = FALSE, shuffle_pairs = FALSE, keep_factor = TRUE, factor_name = ".rearrange_factor")
  # Testing class
  expect_equal(
    class(output_11387),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_11387[["index"]],
    c(9, 7, 5, 3, 1, 2, 4, 6, 8),
    tolerance = 1e-4)
  expect_equal(
    output_11387[["A"]],
    c(2, 6, 4, 3, 9, 8, 5, 7, 1),
    tolerance = 1e-4)
  expect_equal(
    output_11387[["B"]],
    c(0.11749, 0.94001, 0.25543, 0.71911, 0.70506, 0.45774, 0.93467,
      0.46229, 0.97823),
    tolerance = 1e-4)
  expect_equal(
    output_11387[["C"]],
    c("I", "G", "E", "C", "A", "B", "D", "F", "H"),
    fixed = TRUE)
  expect_equal(
    output_11387[[".rearrange_factor"]],
    structure(1:9, .Label = c("1", "2", "3", "4", "5", "6", "7", "8",
      "9"), class = "factor"))
  # Testing column names
  expect_equal(
    names(output_11387),
    c("index", "A", "B", "C", ".rearrange_factor"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_11387),
    c("integer", "integer", "numeric", "character", "factor"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_11387),
    c("integer", "integer", "double", "character", "integer"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_11387),
    c(9L, 5L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_11387)),
    character(0),
    fixed = TRUE)


  ## Finished testing 'rearrange'                                             ####
  #

})

# Test wrappers
test_that("rearrange wrappers pass on arguments", {
  xpectr::set_test_seed(42)

  # Create a data frame
  df <- data.frame(
    "index" = 1:9,
    "A" = sample(1:9),
    "B" = runif(9),
    "C" = LETTERS[1:9],
    stringsAsFactors = FALSE
  )


  ## Pair extremes

  ## Testing 'pair_extremes( data = df, col = "B", unequal...'              ####
  ## Initially generated by xpectr
  xpectr::set_test_seed(42)
  # Assigning output
  output_14749 <- pair_extremes(
      data = df,
      col = "B",
      unequal_method = "first",
      shuffle_members = TRUE,
      shuffle_pairs = TRUE,
      keep_factor = TRUE,
      factor_name = "DifferentName"
    )
  # Testing class
  expect_equal(
    class(output_14749),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_14749[["index"]],
    c(3, 1, 6, 4, 9, 8, 5, 2, 7),
    tolerance = 1e-4)
  expect_equal(
    output_14749[["A"]],
    c(3, 9, 7, 5, 2, 1, 4, 8, 6),
    tolerance = 1e-4)
  expect_equal(
    output_14749[["B"]],
    c(0.71911, 0.70506, 0.46229, 0.93467, 0.11749, 0.97823, 0.25543,
      0.45774, 0.94001),
    tolerance = 1e-4)
  expect_equal(
    output_14749[["C"]],
    c("C", "A", "F", "D", "I", "H", "E", "B", "G"),
    fixed = TRUE)
  expect_equal(
    output_14749[["DifferentName"]],
    structure(c(5L, 5L, 4L, 4L, 1L, 2L, 2L, 3L, 3L), .Label = c("1",
      "2", "3", "4", "5"), class = "factor"))
  # Testing column names
  expect_equal(
    names(output_14749),
    c("index", "A", "B", "C", "DifferentName"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_14749),
    c("integer", "integer", "numeric", "character", "factor"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_14749),
    c("integer", "integer", "double", "character", "integer"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_14749),
    c(9L, 5L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_14749)),
    character(0),
    fixed = TRUE)
  ## Finished testing 'pair_extremes( data = df, col = "B", unequal...'     ####


  # center_max


  ## Testing 'center_max(data = df, col = "B", shuffle_mem...'              ####
  ## Initially generated by xpectr
  xpectr::set_test_seed(42)
  # Assigning output
  output_14622 <- center_max(data = df,
                             col = "B",
                             shuffle_members = TRUE)
  # Testing class
  expect_equal(
    class(output_14622),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_14622[["index"]],
    c(5, 6, 1, 7, 8, 4, 3, 2, 9),
    tolerance = 1e-4)
  expect_equal(
    output_14622[["A"]],
    c(4, 7, 9, 6, 1, 5, 3, 8, 2),
    tolerance = 1e-4)
  expect_equal(
    output_14622[["B"]],
    c(0.25543, 0.46229, 0.70506, 0.94001, 0.97823, 0.93467, 0.71911,
      0.45774, 0.11749),
    tolerance = 1e-4)
  expect_equal(
    output_14622[["C"]],
    c("E", "F", "A", "G", "H", "D", "C", "B", "I"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_14622),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_14622),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_14622),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_14622),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_14622)),
    character(0),
    fixed = TRUE)
  ## Finished testing 'center_max(data = df, col = "B", shuffle_mem...'     ####


  # center_min()


  ## Testing 'center_min(data = df, col = "B", shuffle_mem...'              ####
  ## Initially generated by xpectr
  xpectr::set_test_seed(42)
  # Assigning output
  output_16569 <- center_min(data = df, col = "B", shuffle_members = TRUE)
  # Testing class
  expect_equal(
    class(output_16569),
    "data.frame",
    fixed = TRUE)
  # Testing column values
  expect_equal(
    output_16569[["index"]],
    c(7, 3, 1, 5, 9, 2, 6, 4, 8),
    tolerance = 1e-4)
  expect_equal(
    output_16569[["A"]],
    c(6, 3, 9, 4, 2, 8, 7, 5, 1),
    tolerance = 1e-4)
  expect_equal(
    output_16569[["B"]],
    c(0.94001, 0.71911, 0.70506, 0.25543, 0.11749, 0.45774, 0.46229,
      0.93467, 0.97823),
    tolerance = 1e-4)
  expect_equal(
    output_16569[["C"]],
    c("G", "C", "A", "E", "I", "B", "F", "D", "H"),
    fixed = TRUE)
  # Testing column names
  expect_equal(
    names(output_16569),
    c("index", "A", "B", "C"),
    fixed = TRUE)
  # Testing column classes
  expect_equal(
    xpectr::element_classes(output_16569),
    c("integer", "integer", "numeric", "character"),
    fixed = TRUE)
  # Testing column types
  expect_equal(
    xpectr::element_types(output_16569),
    c("integer", "integer", "double", "character"),
    fixed = TRUE)
  # Testing dimensions
  expect_equal(
    dim(output_16569),
    c(9L, 4L))
  # Testing group keys
  expect_equal(
    colnames(dplyr::group_keys(output_16569)),
    character(0),
    fixed = TRUE)
  ## Finished testing 'center_min(data = df, col = "B", shuffle_mem...'     ####


})

